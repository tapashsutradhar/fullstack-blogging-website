<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Altriveo â€” Post</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
  </head>
  <body onload="loadPost()">
    <div class="container">
      <header class="blog-header lh-1 py-3 border-bottom">
        <div class="row flex-nowrap justify-content-between align-items-center">
          <div class="col-4 pt-1"><a href="/">Home</a></div>
          <div class="col-4 text-center"><a class="blog-header-logo text-dark text-decoration-none" href="/">Altriveo</a></div>
          <div class="col-4 d-flex justify-content-end align-items-center"><a href="/login.html">Admin</a></div>
        </div>
      </header>
    </div>

    <main class="container my-4">
      <div id="postContainer"></div>
    </main>

    <footer class="blog-footer">
      <p>Altriveo</p>
    </footer>

    <script>
      function getQuery(name) {
        const url = new URL(window.location.href);
        return url.searchParams.get(name);
      }

      async function loadPost() {
        const id = getQuery('id');
        if (!id) {
          document.getElementById('postContainer').innerHTML = '<p>Post ID missing</p>';
          return;
        }
        try {
          const res = await fetch('/api/posts/' + id);
          if (!res.ok) {
            document.getElementById('postContainer').innerHTML = '<p>Post not found</p>';
            return;
          }
          const p = await res.json();
          document.getElementById('postContainer').innerHTML = `
            <article class="blog-post">
              <h1 class="blog-post-title">${p.title}</h1>
              <p class="blog-post-meta">${p.created_at}</p>
              <div>${p.content.replace(/\n/g,'<br>')}</div>
            </article>
          `;
        } catch (e) {
          console.error(e);
        }
      }
    </script>
  </body>
</html>
